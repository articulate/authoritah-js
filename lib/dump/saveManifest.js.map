{"version":3,"sources":["../../src/dump/saveManifest.js"],"names":[],"mappings":";;;;;kBASwB,Y;;AATxB;;;;AACA;;;;AACA;;;;;;AAEA,IAAM,SAAS,gBAAE,GAAF,CAAM,gBAAE,IAAF,CAAO,CAAC,IAAD,CAAP,CAAN,CAAf;AACA,IAAM,YAAY,gBAAE,MAAF,CAAS,gBAAE,MAAF,CAAS,MAAT,CAAT,EAChB,gBAAE,MAAF,CAAS,gBAAE,KAAF,CAAQ,KAAK,SAAb,EAAwB,gBAAE,EAA1B,EAA8B,IAA9B,EAAoC,CAApC,CAAT,CADgB,EAEhB,gBAAE,MAAF,CAAS,gBAAE,KAAF,CAAQ,iBAAK,IAAb,EAAmB,gBAAE,EAArB,EAAyB,EAAC,QAAQ,IAAT,EAAzB,CAAT,CAFgB,CAAlB;;AAIe,SAAS,YAAT,CAAsB,QAAtB,EAAgC;AAC7C,MAAM,SAAS,gBAAE,OAAF,CAAU,aAAG,aAAb,EAA4B,CAAC,QAAD,CAA5B,CAAf;;AAEA,SAAO,UAAS,OAAT,EAAkB;AAAA,QACf,KADe,GAC6B,OAD7B,CACf,KADe;AAAA,QACR,WADQ,GAC6B,OAD7B,CACR,WADQ;AAAA,QACgB,MADhB,GAC6B,OAD7B,CACK,OADL,CACgB,MADhB;;;AAGvB,WAAO,gBAAE,OAAF,CAAU,MAAV,EAAkB,UAAU,MAAV,CAAlB,EAAqC,gBAAE,QAAvC,EAAiD;AACtD,aAAO,OAAO,KAAP,CAD+C;AAEtD,mBAAa,OAAO,WAAP;AAFyC,KAAjD,CAAP;AAID,GAPD;AAQD","file":"saveManifest.js","sourcesContent":["import yaml from 'js-yaml'\nimport fs from 'fs'\nimport R from 'ramda'\n\nconst dropId = R.map(R.omit([\"id\"]));\nconst formatter = R.ifElse(R.equals('json'),\n  R.always(R.curry(JSON.stringify)(R.__, null, 2)),\n  R.always(R.curry(yaml.dump)(R.__, {noRefs: true})));\n\nexport default function saveManifest(filename) {\n  const writer = R.partial(fs.writeFileSync, [filename]);\n\n  return function(context) {\n    const { rules, connections, options: { format } } = context;\n\n    return R.compose(writer, formatter(format), R.mergeAll)({\n      rules: dropId(rules),\n      connections: dropId(connections)\n    });\n  }\n}\n"]}