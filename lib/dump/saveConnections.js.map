{"version":3,"sources":["../../src/dump/saveConnections.js"],"names":[],"mappings":";;;;;kBAUwB,e;;AAVxB;;;;AACA;;;;AACA;;;;AAEA,IAAM,aAAa,CAAC,SAAD,EAAY,eAAZ,CAAnB;AACA,IAAM,WAAW,gBAAE,IAAF,CAAO,gBAAE,IAAF,CAAO,UAAP,CAAP,EAA2B,gBAAE,SAAF,CAAY,UAAZ,CAA3B,CAAjB;;AAEA,IAAM,mBAAmB,SAAnB,gBAAmB,CAAC,MAAD;AAAA,SAAY,gBAAE,IAAF,CAAO,QAAP,EAAiB,gBAAE,OAAF,CAAU,gBAAE,GAAF,CAAM,MAAN,CAAV,EAAyB,sCAAa,MAAb,EAAqB,QAArB,CAAzB,CAAjB,CAAZ;AAAA,CAAzB;AACA,IAAM,oBAAoB,gBAAE,IAAF,CAAO,QAAP,EAAiB,uCAAc,MAAd,EAAsB,QAAtB,CAAjB,CAA1B;;AAEe,SAAS,eAAT,CAAyB,OAAzB,EAAkC;AAAA,MACvC,WADuC,GACS,OADT,CACvC,WADuC;AAAA,MACf,iBADe,GACS,OADT,CAC1B,OAD0B,CACf,iBADe;;;AAG/C,MAAM,eAAe,gBAAE,GAAF,CAAM,UAAC,UAAD,EAAgB;AAAA,QACjC,IADiC,GACG,UADH,CACjC,IADiC;AAAA,QAChB,aADgB,GACG,UADH,CAC3B,OAD2B,CAChB,aADgB;;AAEzC,QAAG,gBAAE,KAAF,CAAQ,aAAR,CAAH,EAA2B;AAAE,aAAO,UAAP;AAAoB;;AAEjD,QAAM,eAAe,2BAAe,iBAAf,SAAoC,IAApC,CAArB;AACA,WAAO,gBAAE,OAAF,CAAU,iBAAV,EAA6B,iBAAiB,YAAjB,CAA7B,EAA6D,UAA7D,CAAP;AACD,GANoB,CAArB;;AAQA,SAAO,gBAAE,KAAF,CAAQ,aAAR,EAAuB,aAAa,WAAb,CAAvB,EAAkD,OAAlD,CAAP;AACD","file":"saveConnections.js","sourcesContent":["import R from 'ramda'\nimport saveScripts from '../utils/saveScripts'\nimport { expandObject, combineObject } from '../utils/objectManipulation'\n\nconst scriptPath = ['options', 'customScripts'];\nconst ruleLens = R.lens(R.path(scriptPath), R.assocPath(scriptPath));\n\nconst transformForSave = (saveFn) => R.over(ruleLens, R.compose(R.map(saveFn), expandObject('name', 'script')));\nconst transformForWrite = R.over(ruleLens, combineObject('name', 'script'));\n\nexport default function saveConnections(context) {\n  const { connections, options: { connectionScripts } } = context;\n\n  const saveAndWrite = R.map((connection) => {\n    const { name, options: { customScripts }} = connection;\n    if(R.isNil(customScripts)) { return connection; }\n\n    const saveScriptTo = saveScripts(`${connectionScripts}/${name}`);\n    return R.compose(transformForWrite, transformForSave(saveScriptTo))(connection);\n  });\n\n  return R.assoc('connections', saveAndWrite(connections), context);\n}\n\n"]}